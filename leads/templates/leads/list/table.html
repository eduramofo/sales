{% load leads_extras %}

<div class="row">
    <div class="col-12">

      <table id="lead-table-list" class="table table-bordered table-striped table-responsive">
        <thead>
          <tr>
            <th scope="col">Indicado em</th>
            <th scope="col">Nome</th>
            <th scope="col">Status</th>
            <th scope="col">Prox. Tarefa</th>
            <th scope="col">Referenciador</th>
            <th scope="col">Prioridade?</th>
            <th scope="col">Anotações</th>
          </tr>
        </thead>
        <tbody>
        {% for lead in leads %}
          <tr>
            <td>
              {% if lead|get_referrers_from_lead_first_referring_datetime %}
                {{lead|get_referrers_from_lead_first_referring_datetime|date:"d/m/y"}} {{lead|get_referrers_from_lead_first_referring_datetime|date:"H:i"}}
              {% else %}
                {{lead.created_at|date:"d/m/y"}} {{ lead.created_at|time:"H:i" }}
              {% endif %}
            </td>
            <td><a href="{% url 'leads:update' lead.id %}">{{lead.name}}</a></td>
            <td>{{lead.get_status_display}}</td>
            <td>{{lead|show_next_activities|date:"d/m/y H:i"}}</td>
            <td>{{lead|get_referrers_from_lead_first_name|truncatechars:20}}</td>
            <td class="{% if lead.priority %}bg-success text-white{% endif %}">{% if lead.priority %}Sim{% else %}Não{% endif %}</td>
            <td>{{lead.note|default_if_none:""|truncatechars:45}}</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>

    </div>
</div>
