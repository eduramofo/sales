{% load leads_extras %}

<div class="row">
    <div class="col-12">

      <table class="table table-bordered table-striped table-responsive">
        <thead>
          <tr>
            <th scope="col">Data Indicação</th>
            <th scope="col">Nome</th>
            <th scope="col">Status</th>
            <th scope="col">Indicado Por</th>
            <th scope="col">Qualidade</th>
            <th scope="col">Próximo Contato</th>
            <th scope="col">Anotações</th>
            <th scope="col">Agora?</th>
          </tr>
        </thead>
        <tbody>
        {% for lead in leads %}
          <tr>
            <td>
              {% if lead.indicated_by_datetime %}
                {{lead.indicated_by_datetime|date:"d/m/y"}} {{ lead.indicated_by_datetime|time:"H:i" }}
              {% else %}
                {{lead.created_at|date:"d/m/y"}} {{ lead.created_at|time:"H:i" }}
              {% endif %}
            </td>

            <td><a href="{% url 'leads:update' lead.id %}">{{lead.name}}</a></td>
            <td>{{lead.get_status_display}}</td>
            {% if lead.indicated_by|slice:"0:-16" %}
              <td>{{lead.indicated_by|slice:"0:-16"}}</td>
            {% else %}
              <td>{{lead.indicated_by}}</td>
            {% endif %}
            <td>{{lead.quality}} / 5</td>
            <td>{{lead.next_contact|date:"d/m/y"}} {{ lead.next_contact|time:"H:i" }}</td>
            <td>{{lead.note|default_if_none:""|truncatechars:45}}</td>
            {% run_now_table_data_html lead.id lead.run_now %}
          </tr>
        {% endfor %}
        </tbody>
      </table>

    </div>
</div>
